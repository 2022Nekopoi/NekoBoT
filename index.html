<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T-STORE - Kuota & Aplikasi Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0A183E;
            background-image: url('https://placehold.co/1920x1080/0A183E/4B0082?text=Koneksi+Cyber+XL+%26+AXIS');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        .cyber-card {
            background-color: rgba(10, 10, 25, 0.75);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 255, 255, 0.4);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
            border-radius: 1rem;
        }
        .cyber-button {
            background-color: rgba(224, 64, 251, 0.2);
            border: 1px solid #E040FB;
            color: #E040FB;
            transition: all 0.3s ease;
            box-shadow: 0 0 8px rgba(224, 64, 251, 0.5);
        }
        .cyber-button:hover {
            background-color: #E040FB;
            color: white;
            box-shadow: 0 0 20px rgba(224, 64, 251, 0.8);
        }
        .info-button {
            background-color: rgba(0, 255, 255, 0.15);
            border: 1px solid #00FFFF;
            color: #00FFFF;
        }
        .app-button {
            background-color: rgba(255, 215, 0, 0.15);
            border: 1px solid #FFD700;
            color: #FFD700;
        }
        .product-card {
             transition: all 0.3s ease;
             display: flex;
             flex-direction: column;
        }
        .product-card:hover {
            border-color: rgba(0, 255, 255, 0.8);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
            transform: translateY(-5px);
        }
        .provider-logo {
            height: 20px;
            width: auto;
        }
        .modal-overlay {
            z-index: 50;
            overflow-y: auto;
        }
        .payment-button {
             background-color: rgba(0, 255, 255, 0.1);
             border: 1px solid #00ffff81;
             color: #00FFFF;
             transition: all 0.3s ease;
        }
        .payment-button.active-payment-button {
            background-color: #00FFFF;
            color: #0A183E;
            font-weight: bold;
        }
        .accordion-header svg {
            transition: transform 0.3s ease;
        }
        .accordion-body {
            transition: max-height 0.5s ease-in-out, padding-top 0.5s ease-in-out;
            max-height: 0;
            overflow: hidden;
            padding-top: 0;
        }
        .accordion-body.open {
            max-height: 1200px; /* Cukup besar untuk menampung konten */
            padding-top: 1.5rem;
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-6xl font-black uppercase text-cyan-300" style="text-shadow: 0 0 10px #00FFFF, 0 0 20px #00FFFF;">T-STORE</h1>
            <p class="text-lg text-fuchsia-400 mt-2">Solusi Kuota & Aplikasi Premium Tercepat</p>
        </header>

        <main>
            <!-- MENU UTAMA -->
            <section id="main-menu">
                <div class="cyber-card p-6 mb-8 max-w-2xl mx-auto">
                    <h2 class="text-2xl font-bold text-cyan-300 mb-4 border-b-2 border-cyan-400 pb-2">Informasi Pembayaran</h2>
                    <div class="space-y-3 text-lg">
                        <p><strong class="text-cyan-400">Bank:</strong> Seabank</p>
                        <p><strong class="text-cyan-400">No. Rekening:</strong> 901030212504</p>
                        <p><strong class="text-cyan-400">Atas Nama:</strong> GAGAT GINATA</p>
                        <p class="text-sm text-fuchsia-300 pt-2 border-t border-fuchsia-500/20"><strong>Info:</strong> Pembayaran via QRIS juga tersedia.</p>
                    </div>
                </div>
                <div class="cyber-card p-6 max-w-2xl mx-auto text-center">
                    <h2 class="text-2xl font-bold text-cyan-300 mb-5">Pilih Kategori Produk</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button id="show-otp-button" class="cyber-button font-bold text-base py-5 rounded-xl w-full">PRODUK OTP</button>
                        <button id="show-non-otp-button" class="cyber-button info-button font-bold text-base py-5 rounded-xl w-full">PRODUK NON-OTP</button>
                        <button id="show-app-button" class="cyber-button app-button font-bold text-base py-5 rounded-xl w-full">APLIKASI PREMIUM</button>
                    </div>
                    <h2 class="text-xl font-bold text-cyan-300 my-4 pt-4 border-t border-cyan-500/30">Menu Lainnya</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <a href="https://xlstock.serversaya.site/" target="_blank" rel="noopener noreferrer" class="cyber-button info-button font-semibold py-3 rounded-xl w-full block text-center">Cek Stok</a>
                        <a href="https://jeelsboobz.store/sidompul" target="_blank" rel="noopener noreferrer" class="cyber-button info-button font-semibold py-3 rounded-xl w-full block text-center">Cek Area</a>
                        <button id="show-history-button" class="cyber-button info-button font-semibold py-3 rounded-xl w-full">Riwayat</button>
                    </div>
                </div>
            </section>
            
            <!-- Halaman Produk OTP -->
            <section id="otp-section" class="hidden">
                 <button class="back-button cyber-button font-bold py-2 px-6 rounded-xl mb-6">‚Üê Kembali</button>
                <h2 class="text-3xl font-bold text-center mb-6 text-fuchsia-400">PRODUK OTP</h2>
                <div class="cyber-card p-4 mb-8 text-center bg-red-900/50 border-red-500 max-w-3xl mx-auto">
                    <h3 class="font-bold text-red-400">PERHATIAN PENTING!</h3>
                    <p class="text-sm text-gray-300 mt-2">Produk di halaman ini memerlukan proses OTP manual. <strong class="text-yellow-300 block mt-1">Setelah pembayaran berhasil, Anda WAJIB menghubungi Admin untuk menyelesaikan proses OTP.</strong></p>
                </div>
                <div id="otp-product-container" class="space-y-6">
                    <!-- Konten OTP dirender oleh JS -->
                </div>
            </section>
            
            <!-- Halaman Produk Non-OTP -->
            <section id="non-otp-section" class="hidden">
                <button class="back-button cyber-button font-bold py-2 px-6 rounded-xl mb-6">‚Üê Kembali</button>
                <h2 class="text-3xl font-bold text-center mb-6 text-cyan-300">PRODUK NON-OTP</h2>
                 <div id="non-otp-product-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Cards Produk Non-OTP dirender oleh JS -->
                </div>
            </section>

            <!-- HALAMAN APLIKASI PREMIUM -->
            <section id="app-section" class="hidden">
                <button class="back-button cyber-button font-bold py-2 px-6 rounded-xl mb-6">‚Üê Kembali</button>
                <h2 class="text-3xl font-bold text-center mb-6 text-yellow-300">APLIKASI PREMIUM</h2>
                <div class="cyber-card p-4 mb-8 text-center bg-green-900/50 border-green-500 max-w-3xl mx-auto">
                    <h3 class="font-bold text-green-400">PENTING: Info Aplikasi</h3>
                    <p class="text-sm text-gray-300 mt-2">Produk di halaman ini bukan berbentuk AKUN, melainkan APLIKASI yang sudah dimodifikasi.<strong class="text-yellow-300 block mt-1">Anda hanya perlu install dan langsung pakai, tidak perlu repot ganti-ganti akun.</strong></p>
                </div>
                 <div id="app-product-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                    <!-- Cards Aplikasi dirender oleh JS -->
                </div>
            </section>

             <!-- HALAMAN RIWAYAT TRANSAKSI -->
            <section id="history-section" class="hidden">
                <button class="back-button cyber-button font-bold py-2 px-6 rounded-xl mb-6">‚Üê Kembali</button>
                <h2 class="text-3xl font-bold text-center mb-6 text-cyan-300">Riwayat Transaksi Anda</h2>
                <div id="history-list" class="space-y-4 max-w-4xl mx-auto">
                    <!-- Riwayat akan dimuat di sini oleh JavaScript -->
                </div>
            </section>
        </main>
    </div>

    <!-- Modal 1: Pembayaran -->
    <div id="payment-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center p-4 py-8 overflow-y-auto hidden modal-overlay">
        <div class="cyber-card p-6 md:p-8 max-w-lg w-full relative">
            <button class="close-modal absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h2 class="text-3xl font-bold text-cyan-300 mb-2">Langkah 1: Pembayaran</h2>
            <p class="mb-6 text-gray-300">Membeli: <strong id="payment-modal-product-name" class="text-fuchsia-400 font-semibold"></strong></p>
            <div class="space-y-6">
                <div>
                    <h3 class="text-xl font-bold text-cyan-400 mb-3">Pilih Metode Pembayaran</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <button id="payment-bank-btn" class="payment-button font-semibold py-3 rounded-lg">Transfer Bank</button>
                        <button id="payment-qris-btn" class="payment-button font-semibold py-3 rounded-lg">QRIS</button>
                    </div>
                    <div id="payment-error" class="text-red-400 text-sm mt-2 hidden text-center">Silakan pilih metode pembayaran.</div>
                    <div id="bank-details" class="hidden mt-4 border border-cyan-500 rounded-lg p-4 bg-gray-900/50">
                        <p>Silakan transfer ke rekening berikut:</p>
                        <p class="mt-2"><strong class="text-gray-400">Bank:</strong> Seabank</p>
                        <p><strong class="text-gray-400">No. Rekening:</strong> 901030212504</p>
                        <p><strong class="text-gray-400">Atas Nama:</strong> GAGAT GINATA</p>
                    </div>
                    <div id="qris-details" class="hidden mt-4 text-center">
                        <p class="mb-2">Scan QR Code ini.</p>
                        <img src="https://l.top4top.io/p_35692pj055.png" alt="QRIS T-STORE" class="mx-auto rounded-lg max-w-xs w-full bg-white p-2 border">
                    </div>
                    <div class="mt-4 border-t border-cyan-500/50 pt-3 text-center">
                        <p class="text-sm text-yellow-400 mb-2">PENTING: Mohon transfer sesuai total (termasuk 2 digit unik).</p>
                        <p class="text-lg">Total Bayar:</p>
                        <p id="payment-modal-price" class="text-4xl font-extrabold text-fuchsia-400"></p>
                    </div>
                </div>
                <div>
                    <button id="payment-complete-button" class="w-full cyber-button font-bold py-3 text-lg rounded-xl">Saya Sudah Bayar & Lanjutkan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal 2: Konfirmasi -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center p-4 py-8 overflow-y-auto hidden modal-overlay">
        <div class="cyber-card p-6 md:p-8 max-w-lg w-full relative">
            <button class="close-modal absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h2 class="text-3xl font-bold text-cyan-300 mb-2">Langkah 2: Konfirmasi</h2>
            <p class="mb-6 text-gray-300">Konfirmasi untuk: <strong id="confirmation-modal-product-name" class="text-fuchsia-400 font-semibold"></strong></p>
            <div class="space-y-6">
                <div>
                    <h3 id="phone-number-label" class="text-xl font-bold text-cyan-400 mb-2">Isi Tujuan</h3>
                    <input type="text" id="phone-number" class="bg-gray-900/50 border border-cyan-500 text-white text-lg rounded-lg focus:ring-fuchsia-500 focus:border-fuchsia-500 block w-full p-2.5" placeholder="Nomor HP atau Email" required>
                    <div id="phone-error" class="text-red-400 text-sm mt-2 hidden">Input tidak boleh kosong.</div>
                </div>
                <div>
                    <h3 class="text-xl font-bold text-cyan-400 mb-2">Hubungi Admin</h3>
                    <p class="text-sm text-gray-400 mb-4">Klik tombol di bawah untuk mengirim detail pesanan ke Admin. Jangan lupa lampirkan bukti transfer Anda di WhatsApp.</p>
                    <button id="confirm-purchase-button" class="w-full cyber-button font-bold py-3 text-lg rounded-xl">Kirim Konfirmasi ke Admin</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const adminWhatsAppNumber = '6287859569780';
        const products = {
            otp: [
                { name: "Masa Aktif XL 1 Thn", price: 10000, desc: "<ul><li>‚û°Ô∏è Perpanjang Aktif 30 Hari</li><li>üéÅ 60GB Bundling</li><li>üì± 45GB/Tahun</li><li>‚ñ∂Ô∏è 36GB YouTube/Tahun</li></ul><p class='text-xs text-yellow-400 mt-2 pt-2 border-t border-yellow-400/20'><strong>Catatan:</strong> Hanya mengembalikan masa aktif ke 30 hari, tidak akumulasi.</p>", logo: "xl" },
                { name: "Xtra Combo+ Add-On", price: 9000, desc: "<div class='text-sm'><p>üì∫ YouTube 15GB</p><p>üì∑ Instagram 15GB</p><p>üéµ TikTok 15GB</p><p>üìò Facebook 15GB</p><p>üí¨ WhatsApp 15GB</p><p>üé¨ Streaming 15GB</p><p>üåê Social Media 15GB</p></div>", logo: "xl", priceSuffix: "/ item" }
            ],
            masaAktifSpesial: [
                 { name: "Masa Aktif 30 Hari", price: 5000, desc: "" }, { name: "Aktif 30 Hr + 100MB", price: 5000, desc: "" },
                 { name: "Aktif 45 Hr + 50GB*", price: 5000, desc: "<p class='text-xs text-yellow-400 mt-1'><strong>Detail:</strong> Jadi 45 hari dari tgl beli. Tidak akumulasi.</p>" },
                 { name: "Aktif 45 Hr + 50GB*", price: 5000, desc: "<p class='text-xs text-yellow-400 mt-1'><strong>Detail:</strong> Jadi 45 hari dari tgl beli. Tidak akumulasi.</p>" }
            ],
            addOnAplikasi: [
                 { name: "Add On Youtube 24GB", price: 5000, desc: "<ul class='text-xs text-yellow-400 mt-1 list-disc list-inside'><li>Syarat: Punya XC VIP Plus 75GB & addon diambil.</li><li>Tidak akumulasi.</li><li>Aktif ikut paket utama.</li></ul>" },
                 { name: "Add On Youtube 24GB", price: 5000, desc: "<ul class='text-xs text-yellow-400 mt-1 list-disc list-inside'><li>Syarat: Punya XC VIP Plus 75GB & addon diambil.</li><li>Tidak akumulasi.</li><li>Aktif ikut paket utama.</li></ul>" },
                 { name: "Add On TikTok 10GB", price: 5000, desc: "<ul class='text-xs text-yellow-400 mt-1 list-disc list-inside'><li>Syarat: Punya XC VIP Plus 75GB & addon diambil.</li><li>Tidak akumulasi.</li><li>Aktif ikut paket utama.</li></ul>" },
                 { name: "Add On Facebook 20GB", price: 5000, desc: "<ul class='text-xs text-yellow-400 mt-1 list-disc list-inside'><li>Syarat: Punya XC VIP Plus 75GB & addon diambil.</li><li>Tidak akumulasi.</li><li>Aktif ikut paket utama.</li></ul>" }
            ],
            nonOtp: [
                { name: "AKRAB SMILL", price: 50000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 13GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 15GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 20GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 30GB</li></ul>" },
                { name: "AKRAB SMILL", price: 53000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 19GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 21GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 26GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 36GB</li></ul>" },
                { name: "AKRAB LITE", price: 60000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 31GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 32GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 38GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 48GB</li></ul>" },
                { name: "AKRAB MID", price: 65000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 38GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 40GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 45GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 55GB</li></ul>" },
                { name: "AKRAB MAX", price: 85000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 63GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 65GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 70GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 80GB</li></ul>" },
                { name: "AKRAB LARGE", price: 110000, desc: "<ul><li><span class='font-semibold text-cyan-400'>Area 1:</span> 88GB</li><li><span class='font-semibold text-cyan-400'>Area 2:</span> 90GB</li><li><span class='font-semibold text-cyan-400'>Area 3:</span> 95GB</li><li><span class='font-semibold text-cyan-400'>Area 4:</span> 105GB</li></ul>" },
                { name: "BEBAS PUAS 75GB+", price: 105000, desc: "<ul><li>‚úì Kuota 75GB (All Area)</li><li>‚úì Bonus s/d 90GB</li></ul><p class='text-xs text-gray-400 mt-2 pt-2 border-t border-gray-700'>Paket Garansi Resmi</p>", logo: "xl" },
                { name: "BEBAS PUAS 234GB+", price: 165000, desc: "<ul><li>‚úì Kuota 234GB (All Area)</li><li>‚úì Bonus s/d 270GB</li></ul><p class='text-xs text-gray-400 mt-2 pt-2 border-t border-gray-700'>Paket Garansi Resmi</p>", logo: "xl" }
            ],
            app: [
                { name: "Capcut Premium", price: 5000 }, { name: "VPN Premium", price: 5000 },
                { name: "Joox Premium", price: 5000 }, { name: "Iflix Premium", price: 5000 },
                { name: "ChatGPT Premium", price: 5000 }, { name: "Telegram Premium", price: 5000 }
            ]
        };
        const logoUrls = { xl: "https://b.top4top.io/p_3569f76th1.png", axis: "https://a.top4top.io/p_3569qb2pj0.jpeg" };
        
        function createProductCard(product) {
            const isAkrab = product.name.includes("AKRAB");
            const logoHtml = product.logo === "xl" ? `<div class="absolute top-4 right-4 flex gap-2 items-center"><img src="${logoUrls.xl}" alt="Logo XL" class="provider-logo"></div>` : isAkrab ? `<div class="absolute top-4 right-4 flex gap-2 items-center"><img src="${logoUrls.xl}" alt="Logo XL" class="provider-logo"><img src="${logoUrls.axis}" alt="Logo AXIS" class="provider-logo"></div>` : "";
            const priceHtml = `<p class="text-3xl font-black text-cyan-300 my-3">Rp ${product.price.toLocaleString('id-ID')}<span class="text-xl font-semibold text-gray-400">${product.priceSuffix || ''}</span></p>`;
            return `<div class="cyber-card product-card p-6 relative">${logoHtml}<div class="flex-grow"><h3 class="text-xl font-bold text-fuchsia-400">${product.name}</h3>${priceHtml}<div class="text-sm text-gray-300 space-y-1">${product.desc || ''}</div></div><button class="buy-button mt-6 w-full cyber-button font-bold py-2 rounded-lg" data-product="${product.name}" data-price="${product.price}">Beli Sekarang</button></div>`;
        }
        
        const otpProductContainer = document.getElementById('otp-product-container');
        otpProductContainer.innerHTML = `
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                ${products.otp.map(createProductCard).join('')}
            </div>
            <div class="mt-8">
                <button class="accordion-header w-full text-left text-2xl font-bold text-yellow-300 p-4 border border-yellow-500 rounded-lg flex justify-between items-center">
                    <span>üåü Add On & Paket Spesial üåü</span>
                    <svg class="w-6 h-6 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div class="accordion-body">
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                        ${[...products.masaAktifSpesial, ...products.addOnAplikasi].map(p => createProductCard({...p, logo: 'xl'})).join('')}
                    </div>
                </div>
            </div>`;

        document.getElementById('non-otp-product-grid').innerHTML = products.nonOtp.map(createProductCard).join('');
        document.getElementById('app-product-grid').innerHTML = products.app.map(createProductCard).join('');

        const mainMenu = document.getElementById('main-menu'), allSections = document.querySelectorAll('main > section');
        const navButtons = { 'show-otp-button': 'otp-section', 'show-non-otp-button': 'non-otp-section', 'show-app-button': 'app-section', 'show-history-button': 'history-section' };
        Object.keys(navButtons).forEach(buttonId => document.getElementById(buttonId).addEventListener('click', () => { allSections.forEach(s => s.classList.add('hidden')); document.getElementById(navButtons[buttonId]).classList.remove('hidden'); if (buttonId === 'show-history-button') tampilkanRiwayat(); }));
        document.querySelectorAll('.back-button').forEach(button => button.addEventListener('click', () => { allSections.forEach(s => s.classList.add('hidden')); mainMenu.classList.remove('hidden'); }));
        
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const body = header.nextElementSibling;
                const icon = header.querySelector('svg');
                body.classList.toggle('open');
                icon.classList.toggle('rotate-180');
            });
        });

        const paymentModal = document.getElementById('payment-modal'), confirmationModal = document.getElementById('confirmation-modal'), paymentModalProductName = document.getElementById('payment-modal-product-name'), confirmationModalProductName = document.getElementById('confirmation-modal-product-name'), paymentModalPrice = document.getElementById('payment-modal-price'), phoneNumberInput = document.getElementById('phone-number'), phoneNumberLabel = document.getElementById('phone-number-label'), phoneError = document.getElementById('phone-error'), paymentError = document.getElementById('payment-error'), paymentBankBtn = document.getElementById('payment-bank-btn'), paymentQrisBtn = document.getElementById('payment-qris-btn'), bankDetails = document.getElementById('bank-details'), qrisDetails = document.getElementById('qris-details'), paymentCompleteButton = document.getElementById('payment-complete-button'), confirmPurchaseButton = document.getElementById('confirm-purchase-button');
        let selectedProduct = '', selectedPrice = 0, uniqueCode = 0, finalPrice = 0, orderTime = '', selectedPaymentMethod = '', isAppProduct = false, isOtpProduct = false;
        
        document.addEventListener('click', e => {
            if (e.target.matches('.buy-button')) {
                selectedProduct = e.target.dataset.product; selectedPrice = parseInt(e.target.dataset.price);
                isAppProduct = e.target.closest('#app-section') !== null;
                isOtpProduct = e.target.closest('#otp-section') !== null;
                uniqueCode = Math.floor(Math.random() * 90) + 10; finalPrice = selectedPrice + uniqueCode;
                orderTime = new Date().toLocaleString('id-ID', { dateStyle: 'short', timeStyle: 'medium' });
                paymentModalProductName.textContent = selectedProduct;
                paymentModalPrice.innerHTML = `Rp ${finalPrice.toLocaleString('id-ID')} <br><span class="text-sm text-gray-400 font-normal">(Rp ${selectedPrice.toLocaleString('id-ID')} + kode ${uniqueCode})</span>`;
                resetPaymentSelection(); paymentModal.classList.remove('hidden');
            }
        });
        
        paymentCompleteButton.addEventListener('click', () => {
            if (!selectedPaymentMethod) { paymentError.classList.remove('hidden'); return; }
            paymentError.classList.add('hidden');
            paymentModal.classList.add('hidden');
            confirmationModalProductName.textContent = selectedProduct;
            if (isAppProduct) { phoneNumberLabel.textContent = 'Isi Nomor WhatsApp'; phoneNumberInput.placeholder = '08... (untuk kirim link aplikasi)'; }
            else { phoneNumberLabel.textContent = 'Isi Nomor Tujuan'; phoneNumberInput.placeholder = '08...'; }
            phoneError.classList.add('hidden');
            phoneNumberInput.value = '';
            confirmationModal.classList.remove('hidden');
        });

        function resetPaymentSelection() {
            paymentBankBtn.classList.remove('active-payment-button'); paymentQrisBtn.classList.remove('active-payment-button');
            bankDetails.classList.add('hidden'); qrisDetails.classList.add('hidden');
            selectedPaymentMethod = ''; paymentError.classList.add('hidden');
        }

        paymentBankBtn.addEventListener('click', () => { resetPaymentSelection(); paymentBankBtn.classList.add('active-payment-button'); bankDetails.classList.remove('hidden'); selectedPaymentMethod = 'Transfer Bank'; });
        paymentQrisBtn.addEventListener('click', () => { resetPaymentSelection(); paymentQrisBtn.classList.add('active-payment-button'); qrisDetails.classList.remove('hidden'); selectedPaymentMethod = 'QRIS'; });
        document.querySelectorAll('.close-modal').forEach(btn => btn.addEventListener('click', () => { paymentModal.classList.add('hidden'); confirmationModal.classList.add('hidden'); }));
        
        confirmPurchaseButton.addEventListener('click', () => {
            const destination = phoneNumberInput.value;
            if (!destination.trim()) { phoneError.classList.remove('hidden'); return; }
            phoneError.classList.add('hidden');
            let message;
            const targetLabel = isAppProduct ? 'Nomor WhatsApp' : 'Nomor Tujuan';
            if (isOtpProduct) {
                message = `Halo Admin, SAYA SUDAH BAYAR untuk pesanan:\n\n*Waktu:* ${orderTime}\n*Produk:* ${selectedProduct}\n*Total Transfer:* Rp ${finalPrice.toLocaleString('id-ID')}\n*Nomor Tujuan:* ${destination}\n\nMohon segera diproses OTP-nya. Berikut bukti transfernya.`;
            } else {
                message = `Halo Admin, konfirmasi pesanan:\n\n*Waktu:* ${orderTime}\n*Produk:* ${selectedProduct}\n*Pembayaran:* ${selectedPaymentMethod}\n*Total Transfer:* Rp ${finalPrice.toLocaleString('id-ID')} (kode unik ${uniqueCode})\n*${targetLabel}:* ${destination}\n\nSegera kirim bukti transfer. Thx.`;
            }
            simpanTransaksi({ id: Date.now(), waktu: orderTime, produk: selectedProduct, tujuan: destination, total: finalPrice, status: 'Menunggu Pembayaran' });
            window.open(`https://wa.me/${adminWhatsAppNumber}?text=${encodeURIComponent(message)}`, '_blank');
            confirmationModal.classList.add('hidden');
        });

        function simpanTransaksi(transaksi) {
            let riwayat = JSON.parse(localStorage.getItem('transaksiTStoreCyber')) || [];
            riwayat.unshift(transaksi);
            localStorage.setItem('transaksiTStoreCyber', JSON.stringify(riwayat));
        }

        function tampilkanRiwayat() {
            const historyListEl = document.getElementById('history-list');
            const riwayat = JSON.parse(localStorage.getItem('transaksiTStoreCyber')) || [];
            if (riwayat.length === 0) { historyListEl.innerHTML = `<div class="cyber-card p-6 text-center text-gray-400"><p>Belum ada riwayat transaksi.</p></div>`; return; }
            historyListEl.innerHTML = riwayat.map(trx => `<div class="cyber-card p-4"><div class="grid grid-cols-2 md:grid-cols-4 gap-4 items-center"><div><p class="text-sm text-gray-400">ID Transaksi</p><p class="font-semibold text-gray-300 break-all">${trx.id}</p></div><div><p class="text-sm text-gray-400">Produk</p><p class="font-bold text-fuchsia-400">${trx.produk}</p></div><div class="mt-2 md:mt-0"><p class="text-sm text-gray-400">Tujuan</p><p class="font-semibold break-all">${trx.tujuan}</p></div><div class="mt-2 md:mt-0 text-left md:text-right"><p class="text-sm text-gray-400">Total Bayar</p><p class="font-bold text-lg text-cyan-300">Rp ${trx.total.toLocaleString('id-ID')}</p></div><div class="col-span-2 md:col-span-4 border-t border-gray-700 mt-2 pt-2 flex justify-between items-center"><p class="text-xs text-gray-500">${trx.waktu}</p><span class="text-xs font-bold py-1 px-3 rounded-full bg-yellow-400/20 text-yellow-300">${trx.status}</span></div></div></div>`).join('');
        }
    </script>
</body>
</html>


