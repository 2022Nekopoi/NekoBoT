<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produk OTP</title>
  <style>
    body {font-family: Arial, sans-serif; background:#f8f8f8; margin:0;}
    header {background:linear-gradient(135deg,#6a00f4,#ff0099); color:#fff; padding:20px; text-align:center; border-radius:0 0 20px 20px;}
    .product-list, .product-detail {margin:20px; display:grid; gap:20px;}
    .product, .detail-box {background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
    .product h2 {margin:0 0 10px; color:#6a00f4;}
    .price {font-weight:bold; color:#008000; margin:10px 0;}
    .buy-btn, .back-btn, .reset-btn {
      display:inline-block; padding:10px 20px; border-radius:8px; text-decoration:none;
      font-weight:bold; margin-top:10px; cursor:pointer;
    }
    .buy-btn {background:#6a00f4; color:#fff;}
    .buy-btn:hover {background:#8a2be2;}
    .back-btn {background:#555; color:#fff;}
    .back-btn:hover {background:#333;}
    .reset-btn {background:#f44336; color:#fff;}
    .reset-btn:hover {background:#d32f2f;}
    footer {text-align:center; margin:20px;}
    .hidden {display:none;}
    img {max-width:250px; border-radius:12px; margin:15px 0;}
    table {width:100%; border-collapse:collapse; margin-top:20px;}
    th,td {border:1px solid #ccc; padding:8px; text-align:center;}
    th {background:#eee;}
    .status {font-weight:bold;}
    .belum {color:red;}
    .proses {color:orange;}
    .selesai {color:green;}
    .aksi-btn {padding:4px 8px; margin:2px; border:none; border-radius:6px; cursor:pointer;}
    .btn-belum {background:#ffdddd;}
    .btn-proses {background:#fff3cd;}
    .btn-selesai {background:#d4edda;}
  </style>
  <script>
    // Tampilkan detail produk
    function showDetail(id) {
      document.getElementById('product-list').classList.add('hidden');
      document.getElementById(id).classList.remove('hidden');

      // Buat Order ID unik
      const orderId = "TS-" + new Date().toISOString().slice(0,10).replace(/-/g,"") + "-" + Math.floor(Math.random()*1000);
      document.querySelector("#"+id+" .order-id").innerText = "Order ID: " + orderId;
      document.querySelector("#"+id+" .wa-btn").setAttribute("data-orderid", orderId);
    }

    // Kembali ke daftar produk
    function goBack(id) {
      document.getElementById(id).classList.add('hidden');
      document.getElementById('product-list').classList.remove('hidden');
    }

    // Simpan ke riwayat pembelian
    function simpanRiwayat(namaProduk, harga, orderId) {
      let riwayat = JSON.parse(localStorage.getItem("riwayatPembelian")) || [];
      riwayat.push({produk:namaProduk, harga:harga, orderId:orderId, waktu:new Date().toLocaleString(), status:"Belum Bayar"});
      localStorage.setItem("riwayatPembelian", JSON.stringify(riwayat));
      tampilRiwayat();
    }

    // Tampilkan riwayat pembelian
    function tampilRiwayat() {
      let riwayat = JSON.parse(localStorage.getItem("riwayatPembelian")) || [];
      let tbody = document.getElementById("riwayat-body");
      tbody.innerHTML = "";
      riwayat.forEach((r,i) => {
        tbody.innerHTML += `<tr>
          <td>${r.orderId}</td>
          <td>${r.produk}</td>
          <td>${r.harga}</td>
          <td class="status ${r.status.toLowerCase()}">${r.status}</td>
          <td>${r.waktu}</td>
          <td>
            <button class="aksi-btn btn-belum" onclick="ubahStatus(${i},'Belum Bayar')">Belum</button>
            <button class="aksi-btn btn-proses" onclick="ubahStatus(${i},'Diproses')">Proses</button>
            <button class="aksi-btn btn-selesai" onclick="ubahStatus(${i},'Selesai')">Selesai</button>
          </td>
        </tr>`;
      });
    }

    // Ubah status transaksi
    function ubahStatus(index, statusBaru) {
      let riwayat = JSON.parse(localStorage.getItem("riwayatPembelian")) || [];
      riwayat[index].status = statusBaru;
      localStorage.setItem("riwayatPembelian", JSON.stringify(riwayat));
      tampilRiwayat();
    }

    // Reset riwayat
    function resetRiwayat() {
      if(confirm("Yakin ingin menghapus semua riwayat pembelian?")) {
        localStorage.removeItem("riwayatPembelian");
        tampilRiwayat();
        alert("Riwayat pembelian berhasil dihapus!");
      }
    }

    // Saat klik konfirmasi WA
    function konfirmasiWA(el, produk, harga) {
      const orderId = el.getAttribute("data-orderid");
      simpanRiwayat(produk, harga, orderId);
      const pesan = `Halo, saya sudah bayar ${produk} (${harga})\nOrder ID: ${orderId}`;
      window.open(`https://wa.me/6287859569780?text=${encodeURIComponent(pesan)}`, "_blank");
    }

    window.onload = tampilRiwayat;
  </script>
</head>
<body>
  <header>
    <h1>Produk OTP</h1>
    <p>Paket dengan verifikasi OTP</p>
  </header>

  <!-- Daftar Produk -->
  <section id="product-list" class="product-list">
    <div class="product">
      <h2>ADD-ON (Xtra Combo Plus)</h2>
      <div class="price">Rp10.000</div>
      <p>Kuota 15GB YouTube, IG, TikTok, FB, WA, Streaming, Sosmed, Games.<br>Wajib ada paket Xtra Combo Plus.</p>
      <a href="javascript:void(0)" onclick="showDetail('detail-addon')" class="buy-btn">Beli Sekarang</a>
    </div>

    <div class="product">
      <h2>Paket Circle</h2>
      <div class="price">Rp10.000</div>
      <p>Kuota 4/5GB Full Reguler.<br>Harus bersih dari grup Circle.<br>Wajib OTP dulu.</p>
      <a href="javascript:void(0)" onclick="showDetail('detail-circle')" class="buy-btn">Beli Sekarang</a>
    </div>
  </section>

  <!-- Detail Produk: ADD-ON -->
  <section id="detail-addon" class="product-detail hidden">
    <div class="detail-box">
      <h2>ADD-ON (Xtra Combo Plus)</h2>
      <p>‚óè XCP - Youtube 15GB - 10k<br>‚óè XCP - Instagram 15GB - 10K<br>‚óè XCP - TikTok 15GB - 10K<br>‚óè XCP - Facebook 15GB - 10K</p>
      <p class="order-id"></p>

      <h3>üì≤ Scan QRIS untuk bayar</h3>
      <img src="https://e.top4top.io/p_3534j26v51.jpeg" alt="QRIS">

      <div>
        <a href="javascript:void(0)" class="buy-btn wa-btn"
           onclick="konfirmasiWA(this,'ADD-ON Xtra Combo Plus','Rp10.000')">‚úÖ Konfirmasi via WA</a>
        <a href="javascript:void(0)" onclick="goBack('detail-addon')" class="back-btn">‚¨Ö Kembali</a>
      </div>
    </div>
  </section>

  <!-- Detail Produk: Circle -->
  <section id="detail-circle" class="product-detail hidden">
    <div class="detail-box">
      <h2>Paket Circle</h2>
      <p>Kuota: 4/5GB Full Reguler<br>Harus bersih dari grup Circle<br>Wajib OTP dulu</p>
      <p class="order-id"></p>

      <h3>üì≤ Scan QRIS untuk bayar</h3>
      <img src="https://e.top4top.io/p_3534j26v51.jpeg" alt="QRIS">

      <div>
        <a href="javascript:void(0)" class="buy-btn wa-btn"
           onclick="konfirmasiWA(this,'Paket Circle','Rp10.000')">‚úÖ Konfirmasi via WA</a>
        <a href="javascript:void(0)" onclick="goBack('detail-circle')" class="back-btn">‚¨Ö Kembali</a>
      </div>
    </div>
  </section>

  <!-- Riwayat Pembelian -->
  <section class="product-detail">
    <div class="detail-box">
      <h2>üìú Riwayat Pembelian</h2>
      <button class="reset-btn" onclick="resetRiwayat()">üóë Hapus Semua Riwayat</button>
      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Produk</th>
            <th>Harga</th>
            <th>Status</th>
            <th>Waktu</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="riwayat-body"></tbody>
      </table>
    </div>
  </section>

  <footer>
    <a href="index.html">‚¨Ö Kembali ke Menu Utama</a>
  </footer>
</body>
</html>
